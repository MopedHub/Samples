<head>
    <script type="text/javascript" src="calc.js" ></script>

</head>
<body>
    
        <script type="text/javascript">

            var formulas = [                 
                "3*0.5 -(-5+161/(@var+2* @var5)+(4+6*(12+3)))/4-@var*(0.33-@var55* @var5)",
                "3*5 +(-5+161/(@var+2* @var5)+(4+6*(12+3)))/4-@var*(0.33-@var55* @var5)",
                "3/ 5 +(-5+161/(@var+2* @var5)+(4+6*(12+3)))* -4-@var-@var55* @var5",
                "-3/ 5 +(5+61/ - (@var+2* @var5))* -4-@var-@var55* @var5",
                "(345-12*@var55)+(7-@var5)*(@var+11)",
                "(345-12*@var55)-(7+@var5*(@var/3+11))",
                "0.11/12*35/4.3",
                "-0.11-12-35- 4.3",
                "0-@var55/@var",
                "0-@var55/(1-1)",
                "-3/5 +(5  - -6\1)*#<-4>+-@var-@var55*@var5",
                "0-@var55/(@ErrorVarName-1)",
                "!3-@var55/(4-1)"
            ];

            var params = {
                var: -1.22, 
                var5: 102, 
                var55: 4
            };

            document.write("@var=" + params.var + "&nbsp;&nbsp;@var5=" + params.var5 + "&nbsp;&nbsp;@var55=" + params.var55 + "<br/><br/>");

            document.write("<table style='width:100%'>");
            document.write("<tr><td><b>Source</b></td><td>&nbsp;</td><td><b>Parsing</b></td><td>&nbsp;</td><td><b>Calculate</b></td></tr>");

            for (var i = 0; i < formulas.length; i++) {
                var formula = formulas[i];
                try {
                    var calc = Calc(formula);

                    try {
                        var calcValue = calc.Calculate(params);
                    } catch (e) {
                        var calcValue = e;
                    }
                } catch (e) {
                    calc = "";
                    var calcValue = e;
                }

                document.write("<tr><td>" + formula + "</td><td></td><td>" + calc + "</td><td></td><td>" + calcValue + "</td></tr>");
            }
            document.write("</table>");
        </script>
</body>